{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n  query {\\n    customer @client\\n  }\\n\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  query {\\n    compare @client\\n  }\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  query {\\n    wishlist @client\\n  }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  query {\\n    cartItems @client\\n  }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  query {\\n    user @client\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport { cache } from \"./client\";\nimport { makeVar, gql } from \"@apollo/client\";\nexport var USER = gql(_templateObject());\nexport var CART = gql(_templateObject2());\nexport var WISHLIST = gql(_templateObject3());\nexport var COMPARE = gql(_templateObject4());\nexport var CUSTOMER = gql(_templateObject5()); // initialize\n\nexport var init = function init() {\n  console.log(\"reload cache\");\n  cache.writeQuery({\n    query: USER,\n    data: {\n      user: true ? JSON.parse(localStorage.getItem(\"user\")) : {\n        id: null,\n        email: null,\n        isAdmin: null,\n        isSeller: null\n      }\n    }\n  });\n  cache.writeQuery({\n    query: CART,\n    data: {\n      cartItems: true ? JSON.parse(localStorage.getItem(\"cartItems\") || '{ \"data\": [] }').data : null\n    }\n  });\n  cache.writeQuery({\n    query: COMPARE,\n    data: {\n      compare: true ? JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }').data : null\n    }\n  });\n  cache.writeQuery({\n    query: WISHLIST,\n    data: {\n      wishlist: true ? JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }').data : null\n    }\n  });\n  cache.writeQuery({\n    query: CUSTOMER,\n    data: {\n      customer: {\n        phone: null,\n        name: null,\n        address: null\n      }\n    }\n  });\n};\n\nvar modifyUser = function modifyUser(_ref) {\n  var _user = _ref.user;\n\n  if (true) {\n    if (_user) {\n      localStorage.setItem(\"user\", _JSON$stringify(_user));\n    } else {\n      localStorage.removeItem(\"user\");\n    }\n\n    cache.modify({\n      fields: {\n        user: function user() {\n          return _user;\n        }\n      }\n    });\n  }\n};\n\nvar modifyCart = function modifyCart(_ref2) {\n  var items = _ref2.items;\n\n  if (true) {\n    localStorage.setItem(\"cartItems\", _JSON$stringify({\n      data: items\n    }));\n    cache.modify({\n      fields: {\n        cartItems: function cartItems() {\n          return items;\n        }\n      }\n    });\n  }\n};\n\nvar modifyWishlist = function modifyWishlist(_ref3) {\n  var items = _ref3.items;\n\n  if (true) {\n    localStorage.setItem(\"wishlist\", _JSON$stringify({\n      data: items\n    }));\n    cache.modify({\n      fields: {\n        wishlist: function wishlist() {\n          return items;\n        }\n      }\n    });\n  }\n};\n\nvar modifyCompare = function modifyCompare(_ref4) {\n  var items = _ref4.items;\n\n  if (true) {\n    localStorage.setItem(\"compare\", _JSON$stringify({\n      data: items\n    }));\n    cache.modify({\n      fields: {\n        compare: function compare() {\n          return items;\n        }\n      }\n    });\n  }\n};\n\nvar modifyCustomer = function modifyCustomer(_ref5) {\n  var _customer = _ref5.customer;\n\n  if (true) {\n    if (_customer) {\n      localStorage.setItem(\"customer\", _JSON$stringify(_customer));\n    } else {\n      localStorage.removeItem(\"customer\");\n    }\n\n    cache.modify({\n      fields: {\n        customer: function customer() {\n          return _customer;\n        }\n      }\n    });\n  }\n};\n/* \n    you can use client variable below\n*/\n\n\nexport var emptyCompare = function emptyCompare() {\n  modifyCompare({\n    items: []\n  });\n};\nexport var removeCompareItem = function removeCompareItem(removeItem) {\n  var products = [];\n\n  try {\n    // get\n    products = JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }').data;\n  } catch (_unused) {} // change\n\n\n  var items = [];\n  products.map(function (product) {\n    if (product.id !== removeItem.id) items.push(product);\n  });\n  modifyCompare({\n    items: items\n  });\n};\nexport function addProductToLocalCompare(newProduct) {\n  // get\n  var products = [];\n\n  try {\n    products = JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }').data;\n  } catch (_unused2) {} // change\n\n\n  var others = [];\n  products.map(function (product) {\n    if (product.id !== newProduct.id) {\n      others.push(product);\n    }\n  });\n  var items = [].concat(others, [newProduct]); // save\n\n  modifyCompare({\n    items: items\n  });\n}\nexport var onSignIn = function onSignIn(_ref6) {\n  var user = _ref6.user;\n  modifyUser({\n    user: user\n  });\n};\nexport var onSignOut = function onSignOut() {\n  modifyUser({\n    user: null\n  });\n};\nexport var chooseCustomer = function chooseCustomer(_ref7) {\n  var customer = _ref7.customer;\n  modifyCustomer({\n    customer: customer\n  });\n};\nexport var emptyCart = function emptyCart() {\n  modifyCart({\n    items: []\n  });\n};\nexport var removeCartItem = function removeCartItem(removeItem) {\n  // get\n  var cartItems = JSON.parse(localStorage.getItem(\"cartItems\") || '{ \"data\": [] }').data; // change\n\n  var items = [];\n  cartItems.map(function (item) {\n    if (item.product.id !== removeItem.product.id) items.push(item);\n  });\n  modifyCart({\n    items: items\n  });\n};\nexport var changeCartItem = function changeCartItem(cartItem, change) {\n  // get\n  var cartItems = [];\n\n  try {\n    cartItems = JSON.parse(localStorage.getItem(\"cartItems\") || '{ \"data\": [] }').data;\n  } catch (_unused3) {} // change\n\n\n  var items = [];\n  var price = cartItem.product.price - cartItem.product.sale;\n  cartItems.map(function (item, index) {\n    var quantity = item.quantity + change > 0 ? item.quantity + change : item.quantity;\n\n    if (item.product.id !== cartItem.product.id) {\n      items.push(item);\n    } else {\n      items.push({\n        product: item.product,\n        quantity: quantity,\n        price: price * quantity\n      });\n    }\n  }); // save\n\n  modifyCart({\n    items: items\n  });\n};\nexport function addProductToLocalCart(_ref8) {\n  var product = _ref8.product,\n      variables = _ref8.variables;\n  // get\n  var cartItems = [];\n\n  try {\n    cartItems = JSON.parse(localStorage.getItem(\"cartItems\") || '{ \"data\": [] }').data;\n  } catch (_unused4) {} // change\n\n\n  var items = [];\n  var exist = false;\n  var price = product.price - product.sale;\n  cartItems.map(function (cartItem) {\n    if (cartItem.product.id !== product.id) {\n      items.push(cartItem);\n    } else {\n      exist = true;\n      items.push({\n        product: cartItem.product,\n        quantity: cartItem.quantity + 1,\n        price: price * (cartItem.quantity + 1)\n      });\n    }\n  });\n  if (exist === false) items.push({\n    product: product,\n    quantity: 1,\n    price: price\n  }); // save\n\n  modifyCart({\n    items: items\n  });\n}\nexport var emptyWishlist = function emptyWishlist() {\n  modifyWishlist({\n    items: []\n  });\n};\nexport var removeWishListItem = function removeWishListItem(removeItem) {\n  var products = [];\n\n  try {\n    // get\n    products = JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }').data;\n  } catch (_unused5) {} // change\n\n\n  var items = [];\n  products.map(function (product) {\n    if (product.id !== removeItem.id) items.push(product);\n  });\n  modifyWishlist({\n    items: items\n  });\n};\nexport function addProductToLocalWishlist(newProduct) {\n  // get\n  var products = [];\n\n  try {\n    products = JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }').data;\n  } catch (_unused6) {} // change\n\n\n  var others = [];\n  products.map(function (product) {\n    if (product.id !== newProduct.id) {\n      others.push(product);\n    }\n  });\n  var items = [].concat(others, [newProduct]); // save\n\n  modifyWishlist({\n    items: items\n  });\n}","map":{"version":3,"sources":["/home/huy/apps/ecommerce/app/apollo/action.js"],"names":["cache","makeVar","gql","USER","CART","WISHLIST","COMPARE","CUSTOMER","init","console","log","writeQuery","query","data","user","JSON","parse","localStorage","getItem","id","email","isAdmin","isSeller","cartItems","compare","wishlist","customer","phone","name","address","modifyUser","setItem","removeItem","modify","fields","modifyCart","items","modifyWishlist","modifyCompare","modifyCustomer","emptyCompare","removeCompareItem","products","map","product","push","addProductToLocalCompare","newProduct","others","onSignIn","onSignOut","chooseCustomer","emptyCart","removeCartItem","item","changeCartItem","cartItem","change","price","sale","index","quantity","addProductToLocalCart","variables","exist","emptyWishlist","removeWishListItem","addProductToLocalWishlist"],"mappings":"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","sourcesContent":["import { cache } from \"./client\";\nimport { makeVar, gql } from \"@apollo/client\";\n\nexport const USER = gql`\n  query {\n    user @client\n  }\n`;\nexport const CART = gql`\n  query {\n    cartItems @client\n  }\n`;\nexport const WISHLIST = gql`\n  query {\n    wishlist @client\n  }\n`;\nexport const COMPARE = gql`\n  query {\n    compare @client\n  }\n`;\nexport const CUSTOMER = gql`\n  query {\n    customer @client\n  }\n`;\n// initialize\nexport const init = () => {\n  console.log(\"reload cache\");\n \n  cache.writeQuery({\n    query: USER,\n\n    data: {\n      user:\n        typeof window !== \"undefined\"\n          ? JSON.parse(localStorage.getItem(\"user\"))\n          : { id: null, email: null, isAdmin: null, isSeller: null },\n    },\n  });\n\n  cache.writeQuery({\n    query: CART,\n    data: {\n      cartItems:\n        typeof window !== \"undefined\"\n          ? JSON.parse(localStorage.getItem(\"cartItems\") || '{ \"data\": [] }')\n              .data\n          : null,\n    },\n  });\n  cache.writeQuery({\n    query: COMPARE,\n    data: {\n      compare:\n        typeof window !== \"undefined\"\n          ? JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }').data\n          : null,\n    },\n  });\n  cache.writeQuery({\n    query: WISHLIST,\n    data: {\n      wishlist:\n        typeof window !== \"undefined\"\n          ? JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }')\n              .data\n          : null,\n    },\n  });\n  cache.writeQuery({\n    query: CUSTOMER,\n\n    data: {\n      customer: { phone: null, name: null, address: null },\n    },\n  });\n};\nconst modifyUser = ({ user }) => {\n  if (typeof window !== \"undefined\") {\n    if (user) {\n      localStorage.setItem(\"user\", JSON.stringify(user));\n    } else {\n      localStorage.removeItem(\"user\");\n    }\n    cache.modify({\n      fields: {\n        user() {\n          return user;\n        },\n      },\n    });\n  }\n};\nconst modifyCart = ({ items }) => {\n  if (typeof window !== \"undefined\") {\n    localStorage.setItem(\"cartItems\", JSON.stringify({ data: items }));\n    cache.modify({\n      fields: {\n        cartItems() {\n          return items;\n        },\n      },\n    });\n  }\n};\nconst modifyWishlist = ({ items }) => {\n  if (typeof window !== \"undefined\") {\n    localStorage.setItem(\"wishlist\", JSON.stringify({ data: items }));\n    cache.modify({\n      fields: {\n        wishlist() {\n          return items;\n        },\n      },\n    });\n  }\n};\nconst modifyCompare = ({ items }) => {\n  if (typeof window !== \"undefined\") {\n    localStorage.setItem(\"compare\", JSON.stringify({ data: items }));\n    cache.modify({\n      fields: {\n        compare() {\n          return items;\n        },\n      },\n    });\n  }\n};\n\nconst modifyCustomer = ({ customer }) => {\n  if (typeof window !== \"undefined\") {\n    if (customer) {\n      localStorage.setItem(\"customer\", JSON.stringify(customer));\n    } else {\n      localStorage.removeItem(\"customer\");\n    }\n    cache.modify({\n      fields: {\n        customer() {\n          return customer;\n        },\n      },\n    });\n  }\n};\n\n/* \n    you can use client variable below\n*/\nexport const emptyCompare = () => {\n  modifyCompare({ items: [] });\n};\nexport const removeCompareItem = function (removeItem) {\n  let products = [];\n  try {\n    // get\n    products = JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }')\n      .data;\n  } catch {}\n\n  // change\n  let items = [];\n  products.map((product) => {\n    if (product.id !== removeItem.id) items.push(product);\n  });\n  modifyCompare({ items });\n};\nexport function addProductToLocalCompare(newProduct) {\n  // get\n\n  let products = [];\n  try {\n    products = JSON.parse(localStorage.getItem(\"compare\") || '{ \"data\": [] }')\n      .data;\n  } catch {}\n\n  // change\n  let others = [];\n  products.map((product) => {\n    if (product.id !== newProduct.id) {\n      others.push(product);\n    }\n  });\n  const items = [...others, newProduct];\n\n  // save\n  modifyCompare({ items });\n}\n\nexport const onSignIn = ({ user }) => {\n  modifyUser({ user });\n};\nexport const onSignOut = () => {\n  modifyUser({ user: null });\n};\n\nexport const chooseCustomer = ({ customer }) => {\n  modifyCustomer({ customer });\n};\n\nexport const emptyCart = function () {\n  modifyCart({ items: [] });\n};\nexport const removeCartItem = (removeItem) => {\n  // get\n  const cartItems = JSON.parse(\n    localStorage.getItem(\"cartItems\") || '{ \"data\": [] }'\n  ).data;\n  // change\n  let items = [];\n  cartItems.map((item) => {\n    if (item.product.id !== removeItem.product.id) items.push(item);\n  });\n  modifyCart({ items });\n};\nexport const changeCartItem = function (cartItem, change) {\n  // get\n  let cartItems = [];\n  try {\n    cartItems = JSON.parse(\n      localStorage.getItem(\"cartItems\") || '{ \"data\": [] }'\n    ).data;\n  } catch {}\n\n  // change\n  let items = [];\n  const price = cartItem.product.price - cartItem.product.sale;\n\n  cartItems.map((item, index) => {\n    const quantity =\n      item.quantity + change > 0 ? item.quantity + change : item.quantity;\n    if (item.product.id !== cartItem.product.id) {\n      items.push(item);\n    } else {\n      items.push({\n        product: item.product,\n        quantity,\n        price: price * quantity,\n      });\n    }\n  });\n  // save\n  modifyCart({ items });\n};\n\nexport function addProductToLocalCart({ product, variables }) {\n  // get\n\n  let cartItems = [];\n  try {\n    cartItems = JSON.parse(\n      localStorage.getItem(\"cartItems\") || '{ \"data\": [] }'\n    ).data;\n  } catch {}\n\n  // change\n  let items = [];\n  let exist = false;\n  const price = product.price - product.sale;\n\n  cartItems.map((cartItem) => {\n    if (cartItem.product.id !== product.id) {\n      items.push(cartItem);\n    } else {\n      exist = true;\n      items.push({\n        product: cartItem.product,\n        quantity: cartItem.quantity + 1,\n        price: price * (cartItem.quantity + 1),\n      });\n    }\n  });\n  if (exist === false) items.push({ product, quantity: 1, price });\n  // save\n  modifyCart({ items });\n}\nexport const emptyWishlist = function () {\n  modifyWishlist({ items: [] });\n};\nexport const removeWishListItem = function (removeItem) {\n  let products = [];\n  try {\n    // get\n    products = JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }')\n      .data;\n  } catch {}\n\n  // change\n  let items = [];\n  products.map((product) => {\n    if (product.id !== removeItem.id) items.push(product);\n  });\n  modifyWishlist({ items });\n};\n\nexport function addProductToLocalWishlist(newProduct) {\n  // get\n\n  let products = [];\n  try {\n    products = JSON.parse(localStorage.getItem(\"wishlist\") || '{ \"data\": [] }')\n      .data;\n  } catch {}\n\n  // change\n  let others = [];\n  products.map((product) => {\n    if (product.id !== newProduct.id) {\n      others.push(product);\n    }\n  });\n  const items = [...others, newProduct];\n\n  // save\n  modifyWishlist({ items });\n}\n"]},"metadata":{},"sourceType":"module"}