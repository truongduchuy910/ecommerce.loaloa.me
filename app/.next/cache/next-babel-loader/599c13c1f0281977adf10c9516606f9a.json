{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/home/huy/apps/loaloa/app/pages/signin.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation($email: String!, $password: String!) {\\n    authenticateUserWithPassword(email: $email, password: $password) {\\n      token\\n      item {\\n        id\\n        email\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { gql } from \"@apollo/client\";\nimport { useMutation, useApolloClient } from \"@apollo/client\";\nimport { getErrorMessage } from \"../lib/form\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Link from \"@material-ui/core/Link\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Container from \"@material-ui/core/Container\";\nimport Logo from \"../src/logo\";\nvar useStyles = makeStyles(function (theme) {\n  return {\n    paper: {\n      marginTop: theme.spacing(8),\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"center\"\n    },\n    avatar: {\n      margin: theme.spacing(1),\n      backgroundColor: theme.palette.secondary.main\n    },\n    form: {\n      width: \"100%\",\n      // Fix IE 11 issue.\n      marginTop: theme.spacing(1)\n    },\n    submit: {\n      margin: theme.spacing(3, 0, 2)\n    }\n  };\n});\nvar SignInMutation = gql(_templateObject());\n\nfunction SignIn() {\n  var client = useApolloClient();\n\n  var _useMutation = useMutation(SignInMutation),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      signIn = _useMutation2[0];\n\n  var _useState = useState(),\n      errorMsg = _useState[0],\n      setErrorMsg = _useState[1];\n\n  var router = useRouter();\n\n  function handleSubmit(event) {\n    var emailElement, passwordElement, _ref, data;\n\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            event.preventDefault();\n            emailElement = event.currentTarget.elements.email;\n            passwordElement = event.currentTarget.elements.password;\n            _context.prev = 3;\n            _context.next = 6;\n            return _regeneratorRuntime.awrap(client.resetStore());\n\n          case 6:\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(signIn({\n              variables: {\n                email: emailElement.value,\n                password: passwordElement.value\n              }\n            }));\n\n          case 8:\n            _ref = _context.sent;\n            data = _ref.data;\n\n            if (!data.authenticateUserWithPassword) {\n              _context.next = 13;\n              break;\n            }\n\n            _context.next = 13;\n            return _regeneratorRuntime.awrap(router.push(\"/\"));\n\n          case 13:\n            _context.next = 18;\n            break;\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](3);\n            setErrorMsg(getErrorMessage(_context.t0));\n\n          case 18:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[3, 15]]);\n  }\n\n  var classes = useStyles();\n  return __jsx(Container, {\n    component: \"main\",\n    maxWidth: \"xs\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, __jsx(CssBaseline, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    className: classes.paper,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, __jsx(Typography, {\n    component: \"h1\",\n    variant: \"h5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, \"\\u0110\\u0103ng nh\\u1EADp\"), __jsx(\"form\", {\n    className: classes.form,\n    noValidate: true,\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, __jsx(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    required: true,\n    fullWidth: true,\n    id: \"email\",\n    label: \"T\\xE0i kho\\u1EA3n\",\n    name: \"email\",\n    autoComplete: \"email\",\n    autoFocus: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }), __jsx(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    required: true,\n    fullWidth: true,\n    name: \"password\",\n    label: \"M\\u1EADt kh\\u1EA9u\",\n    type: \"password\",\n    id: \"password\",\n    autoComplete: \"current-password\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }), __jsx(Button, {\n    type: \"submit\",\n    fullWidth: true,\n    variant: \"contained\",\n    color: \"primary\",\n    className: classes.submit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, \"\\u0110\\u0103ng Nh\\u1EADp\")), errorMsg));\n}\n\nexport default SignIn;","map":{"version":3,"sources":["/home/huy/apps/loaloa/app/pages/signin.js"],"names":["useState","useRouter","gql","useMutation","useApolloClient","getErrorMessage","Button","CssBaseline","TextField","Link","Grid","Typography","makeStyles","Container","Logo","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","palette","secondary","main","form","width","submit","SignInMutation","SignIn","client","signIn","errorMsg","setErrorMsg","router","handleSubmit","event","preventDefault","emailElement","currentTarget","elements","email","passwordElement","password","resetStore","variables","value","data","authenticateUserWithPassword","push","classes"],"mappings":"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","sourcesContent":["import { useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { gql } from \"@apollo/client\";\nimport { useMutation, useApolloClient } from \"@apollo/client\";\nimport { getErrorMessage } from \"../lib/form\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Link from \"@material-ui/core/Link\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Container from \"@material-ui/core/Container\";\nimport Logo from \"../src/logo\";\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    marginTop: theme.spacing(8),\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n  },\n  avatar: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.secondary.main,\n  },\n  form: {\n    width: \"100%\", // Fix IE 11 issue.\n    marginTop: theme.spacing(1),\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2),\n  },\n}));\n\nconst SignInMutation = gql`\n  mutation($email: String!, $password: String!) {\n    authenticateUserWithPassword(email: $email, password: $password) {\n      token\n      item {\n        id\n        email\n      }\n    }\n  }\n`;\nfunction SignIn() {\n  const client = useApolloClient();\n  const [signIn] = useMutation(SignInMutation);\n  const [errorMsg, setErrorMsg] = useState();\n  const router = useRouter();\n\n  async function handleSubmit(event) {\n    event.preventDefault();\n\n    const emailElement = event.currentTarget.elements.email;\n    const passwordElement = event.currentTarget.elements.password;\n\n    try {\n      await client.resetStore();\n      const { data } = await signIn({\n        variables: {\n          email: emailElement.value,\n          password: passwordElement.value,\n        },\n      });\n      if (data.authenticateUserWithPassword) {\n        await router.push(\"/\");\n      }\n    } catch (error) {\n      setErrorMsg(getErrorMessage(error));\n    }\n  }\n  const classes = useStyles();\n  return (\n    <Container component=\"main\" maxWidth=\"xs\">\n      <CssBaseline />\n      <div className={classes.paper}>\n        {/* <Logo /> */}\n        <Typography component=\"h1\" variant=\"h5\">\n          Đăng nhập\n        </Typography>\n\n        <form className={classes.form} noValidate onSubmit={handleSubmit}>\n          <TextField\n            variant=\"outlined\"\n            margin=\"normal\"\n            required\n            fullWidth\n            id=\"email\"\n            label=\"Tài khoản\"\n            name=\"email\"\n            autoComplete=\"email\"\n            autoFocus\n          />\n          <TextField\n            variant=\"outlined\"\n            margin=\"normal\"\n            required\n            fullWidth\n            name=\"password\"\n            label=\"Mật khẩu\"\n            type=\"password\"\n            id=\"password\"\n            autoComplete=\"current-password\"\n          />\n\n          <Button\n            type=\"submit\"\n            fullWidth\n            variant=\"contained\"\n            color=\"primary\"\n            className={classes.submit}\n          >\n            Đăng Nhập\n          </Button>\n          {/* <Grid container>\n            <Grid item>\n              <Link href=\"/signup\" variant=\"body2\">\n                {\"Đăng ký\"}\n              </Link>\n            </Grid>\n          </Grid> */}\n        </form>\n        {errorMsg}\n      </div>\n    </Container>\n  );\n}\n\nexport default SignIn;\n"]},"metadata":{},"sourceType":"module"}