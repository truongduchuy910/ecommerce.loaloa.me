{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _jsxFileName = \"/home/huy/apps/tuvilogic/app/pages/signin.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation($email: String!, $password: String!) {\\n    authenticateUserWithPassword(email: $email, password: $password) {\\n      token\\n      item {\\n        id\\n        email\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { gql } from \"@apollo/client\";\nimport { useMutation, useApolloClient } from \"@apollo/client\";\nimport { getErrorMessage } from \"../lib/form\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Link from \"@material-ui/core/Link\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Container from \"@material-ui/core/Container\";\nimport Logo from \"../src/logo\";\nvar useStyles = makeStyles(function (theme) {\n  return {\n    paper: {\n      marginTop: theme.spacing(8),\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"center\"\n    },\n    avatar: {\n      margin: theme.spacing(1),\n      backgroundColor: theme.palette.secondary.main\n    },\n    form: {\n      width: \"100%\",\n      // Fix IE 11 issue.\n      marginTop: theme.spacing(1)\n    },\n    submit: {\n      margin: theme.spacing(3, 0, 2)\n    }\n  };\n});\nvar SignInMutation = gql(_templateObject());\n\nfunction SignIn() {\n  _s();\n\n  var client = useApolloClient();\n\n  var _useMutation = useMutation(SignInMutation),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      signIn = _useMutation2[0];\n\n  var _useState = useState(),\n      errorMsg = _useState[0],\n      setErrorMsg = _useState[1];\n\n  var router = useRouter();\n\n  function handleSubmit(_x) {\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  function _handleSubmit() {\n    _handleSubmit = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(event) {\n      var emailElement, passwordElement, _ref, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              emailElement = event.currentTarget.elements.email;\n              passwordElement = event.currentTarget.elements.password;\n              _context.prev = 3;\n              _context.next = 6;\n              return client.resetStore();\n\n            case 6:\n              _context.next = 8;\n              return signIn({\n                variables: {\n                  email: emailElement.value,\n                  password: passwordElement.value\n                }\n              });\n\n            case 8:\n              _ref = _context.sent;\n              data = _ref.data;\n\n              if (!data.authenticateUserWithPassword) {\n                _context.next = 13;\n                break;\n              }\n\n              _context.next = 13;\n              return router.push(\"/\");\n\n            case 13:\n              _context.next = 18;\n              break;\n\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](3);\n              setErrorMsg(getErrorMessage(_context.t0));\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 15]]);\n    }));\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  var classes = useStyles();\n  return __jsx(Container, {\n    component: \"main\",\n    maxWidth: \"xs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 5\n    }\n  }, __jsx(CssBaseline, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }\n  }), __jsx(\"div\", {\n    className: classes.paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }\n  }, __jsx(Logo, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }\n  }), __jsx(Typography, {\n    component: \"h1\",\n    variant: \"h5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }\n  }, \"\\u0110\\u0103ng nh\\u1EADp\"), __jsx(\"form\", {\n    className: classes.form,\n    noValidate: true,\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  }, __jsx(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    required: true,\n    fullWidth: true,\n    id: \"email\",\n    label: \"T\\xE0i kho\\u1EA3n\",\n    name: \"email\",\n    autoComplete: \"email\",\n    autoFocus: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 11\n    }\n  }), __jsx(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    required: true,\n    fullWidth: true,\n    name: \"password\",\n    label: \"M\\u1EADt kh\\u1EA9u\",\n    type: \"password\",\n    id: \"password\",\n    autoComplete: \"current-password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 11\n    }\n  }), __jsx(Button, {\n    type: \"submit\",\n    fullWidth: true,\n    variant: \"contained\",\n    color: \"primary\",\n    className: classes.submit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 11\n    }\n  }, \"\\u0110\\u0103ng Nh\\u1EADp\"), __jsx(Grid, {\n    container: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 11\n    }\n  }, __jsx(Grid, {\n    item: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }\n  }, __jsx(Link, {\n    href: \"/signup\",\n    variant: \"body2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 15\n    }\n  }, \"Đăng ký\")))), errorMsg));\n}\n\n_s(SignIn, \"lFhFtbQT76OxjNZbM9Wg8jCVszg=\", false, function () {\n  return [useApolloClient, useMutation, useRouter, useStyles];\n});\n\n_c = SignIn;\nexport default SignIn;\n\nvar _c;\n\n$RefreshReg$(_c, \"SignIn\");","map":{"version":3,"sources":["/home/huy/apps/tuvilogic/app/pages/signin.js"],"names":["useState","useRouter","gql","useMutation","useApolloClient","getErrorMessage","Button","CssBaseline","TextField","Link","Grid","Typography","makeStyles","Container","Logo","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","palette","secondary","main","form","width","submit","SignInMutation","SignIn","client","signIn","errorMsg","setErrorMsg","router","handleSubmit","event","preventDefault","emailElement","currentTarget","elements","email","passwordElement","password","resetStore","variables","value","data","authenticateUserWithPassword","push","classes"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,QAAT,QAAyB,OAAzB;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SAASC,GAAT,QAAoB,gBAApB;AACA,SAASC,WAAT,EAAsBC,eAAtB,QAA6C,gBAA7C;AACA,SAASC,eAAT,QAAgC,aAAhC;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,WAAP,MAAwB,+BAAxB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,IAAP,MAAiB,wBAAjB;AACA,OAAOC,IAAP,MAAiB,wBAAjB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,IAAP,MAAiB,aAAjB;AACA,IAAMC,SAAS,GAAGH,UAAU,CAAC,UAACI,KAAD;AAAA,SAAY;AACvCC,IAAAA,KAAK,EAAE;AACLC,MAAAA,SAAS,EAAEF,KAAK,CAACG,OAAN,CAAc,CAAd,CADN;AAELC,MAAAA,OAAO,EAAE,MAFJ;AAGLC,MAAAA,aAAa,EAAE,QAHV;AAILC,MAAAA,UAAU,EAAE;AAJP,KADgC;AAOvCC,IAAAA,MAAM,EAAE;AACNC,MAAAA,MAAM,EAAER,KAAK,CAACG,OAAN,CAAc,CAAd,CADF;AAENM,MAAAA,eAAe,EAAET,KAAK,CAACU,OAAN,CAAcC,SAAd,CAAwBC;AAFnC,KAP+B;AAWvCC,IAAAA,IAAI,EAAE;AACJC,MAAAA,KAAK,EAAE,MADH;AACW;AACfZ,MAAAA,SAAS,EAAEF,KAAK,CAACG,OAAN,CAAc,CAAd;AAFP,KAXiC;AAevCY,IAAAA,MAAM,EAAE;AACNP,MAAAA,MAAM,EAAER,KAAK,CAACG,OAAN,CAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB;AADF;AAf+B,GAAZ;AAAA,CAAD,CAA5B;AAoBA,IAAMa,cAAc,GAAG9B,GAAH,mBAApB;;AAWA,SAAS+B,MAAT,GAAkB;AAAA;;AAChB,MAAMC,MAAM,GAAG9B,eAAe,EAA9B;;AADgB,qBAECD,WAAW,CAAC6B,cAAD,CAFZ;AAAA;AAAA,MAETG,MAFS;;AAAA,kBAGgBnC,QAAQ,EAHxB;AAAA,MAGToC,QAHS;AAAA,MAGCC,WAHD;;AAIhB,MAAMC,MAAM,GAAGrC,SAAS,EAAxB;;AAJgB,WAMDsC,YANC;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,6BAMhB,iBAA4BC,KAA5B;AAAA;;AAAA;AAAA;AAAA;AAAA;AACEA,cAAAA,KAAK,CAACC,cAAN;AAEMC,cAAAA,YAHR,GAGuBF,KAAK,CAACG,aAAN,CAAoBC,QAApB,CAA6BC,KAHpD;AAIQC,cAAAA,eAJR,GAI0BN,KAAK,CAACG,aAAN,CAAoBC,QAApB,CAA6BG,QAJvD;AAAA;AAAA;AAAA,qBAOUb,MAAM,CAACc,UAAP,EAPV;;AAAA;AAAA;AAAA,qBAQ2Bb,MAAM,CAAC;AAC5Bc,gBAAAA,SAAS,EAAE;AACTJ,kBAAAA,KAAK,EAAEH,YAAY,CAACQ,KADX;AAETH,kBAAAA,QAAQ,EAAED,eAAe,CAACI;AAFjB;AADiB,eAAD,CARjC;;AAAA;AAAA;AAQYC,cAAAA,IARZ,QAQYA,IARZ;;AAAA,mBAcQA,IAAI,CAACC,4BAdb;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAeYd,MAAM,CAACe,IAAP,CAAY,GAAZ,CAfZ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAkBIhB,cAAAA,WAAW,CAAChC,eAAe,aAAhB,CAAX;;AAlBJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KANgB;AAAA;AAAA;;AA2BhB,MAAMiD,OAAO,GAAGvC,SAAS,EAAzB;AACA,SACE,MAAC,SAAD;AAAW,IAAA,SAAS,EAAC,MAArB;AAA4B,IAAA,QAAQ,EAAC,IAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE;AAAK,IAAA,SAAS,EAAEuC,OAAO,CAACrC,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,MAAC,UAAD;AAAY,IAAA,SAAS,EAAC,IAAtB;AAA2B,IAAA,OAAO,EAAC,IAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCAFF,EAME;AAAM,IAAA,SAAS,EAAEqC,OAAO,CAACzB,IAAzB;AAA+B,IAAA,UAAU,MAAzC;AAA0C,IAAA,QAAQ,EAAEU,YAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,SAAD;AACE,IAAA,OAAO,EAAC,UADV;AAEE,IAAA,MAAM,EAAC,QAFT;AAGE,IAAA,QAAQ,MAHV;AAIE,IAAA,SAAS,MAJX;AAKE,IAAA,EAAE,EAAC,OALL;AAME,IAAA,KAAK,EAAC,mBANR;AAOE,IAAA,IAAI,EAAC,OAPP;AAQE,IAAA,YAAY,EAAC,OARf;AASE,IAAA,SAAS,MATX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAYE,MAAC,SAAD;AACE,IAAA,OAAO,EAAC,UADV;AAEE,IAAA,MAAM,EAAC,QAFT;AAGE,IAAA,QAAQ,MAHV;AAIE,IAAA,SAAS,MAJX;AAKE,IAAA,IAAI,EAAC,UALP;AAME,IAAA,KAAK,EAAC,oBANR;AAOE,IAAA,IAAI,EAAC,UAPP;AAQE,IAAA,EAAE,EAAC,UARL;AASE,IAAA,YAAY,EAAC,kBATf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAZF,EAwBE,MAAC,MAAD;AACE,IAAA,IAAI,EAAC,QADP;AAEE,IAAA,SAAS,MAFX;AAGE,IAAA,OAAO,EAAC,WAHV;AAIE,IAAA,KAAK,EAAC,SAJR;AAKE,IAAA,SAAS,EAAEe,OAAO,CAACvB,MALrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCAxBF,EAiCE,MAAC,IAAD;AAAM,IAAA,SAAS,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,IAAD;AAAM,IAAA,IAAI,MAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,IAAD;AAAM,IAAA,IAAI,EAAC,SAAX;AAAqB,IAAA,OAAO,EAAC,OAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,SADH,CADF,CADF,CAjCF,CANF,EA+CGK,QA/CH,CAFF,CADF;AAsDD;;GAlFQH,M;UACQ7B,e,EACED,W,EAEFF,S,EAuBCc,S;;;KA3BTkB,M;AAoFT,eAAeA,MAAf","sourcesContent":["import { useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { gql } from \"@apollo/client\";\nimport { useMutation, useApolloClient } from \"@apollo/client\";\nimport { getErrorMessage } from \"../lib/form\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Link from \"@material-ui/core/Link\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Container from \"@material-ui/core/Container\";\nimport Logo from \"../src/logo\";\nconst useStyles = makeStyles((theme) => ({\n  paper: {\n    marginTop: theme.spacing(8),\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n  },\n  avatar: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.secondary.main,\n  },\n  form: {\n    width: \"100%\", // Fix IE 11 issue.\n    marginTop: theme.spacing(1),\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2),\n  },\n}));\n\nconst SignInMutation = gql`\n  mutation($email: String!, $password: String!) {\n    authenticateUserWithPassword(email: $email, password: $password) {\n      token\n      item {\n        id\n        email\n      }\n    }\n  }\n`;\nfunction SignIn() {\n  const client = useApolloClient();\n  const [signIn] = useMutation(SignInMutation);\n  const [errorMsg, setErrorMsg] = useState();\n  const router = useRouter();\n\n  async function handleSubmit(event) {\n    event.preventDefault();\n\n    const emailElement = event.currentTarget.elements.email;\n    const passwordElement = event.currentTarget.elements.password;\n\n    try {\n      await client.resetStore();\n      const { data } = await signIn({\n        variables: {\n          email: emailElement.value,\n          password: passwordElement.value,\n        },\n      });\n      if (data.authenticateUserWithPassword) {\n        await router.push(\"/\");\n      }\n    } catch (error) {\n      setErrorMsg(getErrorMessage(error));\n    }\n  }\n  const classes = useStyles();\n  return (\n    <Container component=\"main\" maxWidth=\"xs\">\n      <CssBaseline />\n      <div className={classes.paper}>\n        <Logo />\n        <Typography component=\"h1\" variant=\"h5\">\n          Đăng nhập\n        </Typography>\n\n        <form className={classes.form} noValidate onSubmit={handleSubmit}>\n          <TextField\n            variant=\"outlined\"\n            margin=\"normal\"\n            required\n            fullWidth\n            id=\"email\"\n            label=\"Tài khoản\"\n            name=\"email\"\n            autoComplete=\"email\"\n            autoFocus\n          />\n          <TextField\n            variant=\"outlined\"\n            margin=\"normal\"\n            required\n            fullWidth\n            name=\"password\"\n            label=\"Mật khẩu\"\n            type=\"password\"\n            id=\"password\"\n            autoComplete=\"current-password\"\n          />\n\n          <Button\n            type=\"submit\"\n            fullWidth\n            variant=\"contained\"\n            color=\"primary\"\n            className={classes.submit}\n          >\n            Đăng Nhập\n          </Button>\n          <Grid container>\n            <Grid item>\n              <Link href=\"/signup\" variant=\"body2\">\n                {\"Đăng ký\"}\n              </Link>\n            </Grid>\n          </Grid>\n        </form>\n        {errorMsg}\n      </div>\n    </Container>\n  );\n}\n\nexport default SignIn;\n"]},"metadata":{},"sourceType":"module"}