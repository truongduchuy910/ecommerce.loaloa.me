{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation($email: String!, $password: String!) {\\n    authenticateUserWithPassword(email: $email, password: $password) {\\n      token\\n      item {\\n        id\\n        email\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { gql } from \"@apollo/client\";\nimport { useMutation, useApolloClient } from \"@apollo/client\";\nimport { getErrorMessage } from \"../lib/form\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Link from \"@material-ui/core/Link\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Container from \"@material-ui/core/Container\";\nimport Logo from \"../src/logo\";\nvar useStyles = makeStyles(function (theme) {\n  return {\n    paper: {\n      marginTop: theme.spacing(8),\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"center\"\n    },\n    avatar: {\n      margin: theme.spacing(1),\n      backgroundColor: theme.palette.secondary.main\n    },\n    form: {\n      width: \"100%\",\n      // Fix IE 11 issue.\n      marginTop: theme.spacing(1)\n    },\n    submit: {\n      margin: theme.spacing(3, 0, 2)\n    }\n  };\n});\nvar SignInMutation = gql(_templateObject());\n\nfunction SignIn() {\n  var client = useApolloClient();\n\n  var _useMutation = useMutation(SignInMutation),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      signIn = _useMutation2[0];\n\n  var _useState = useState(),\n      errorMsg = _useState[0],\n      setErrorMsg = _useState[1];\n\n  var router = useRouter();\n\n  function handleSubmit(event) {\n    var emailElement, passwordElement, _ref, data;\n\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            event.preventDefault();\n            emailElement = event.currentTarget.elements.email;\n            passwordElement = event.currentTarget.elements.password;\n            _context.prev = 3;\n            _context.next = 6;\n            return _regeneratorRuntime.awrap(client.resetStore());\n\n          case 6:\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(signIn({\n              variables: {\n                email: emailElement.value,\n                password: passwordElement.value\n              }\n            }));\n\n          case 8:\n            _ref = _context.sent;\n            data = _ref.data;\n\n            if (!data.authenticateUserWithPassword) {\n              _context.next = 13;\n              break;\n            }\n\n            _context.next = 13;\n            return _regeneratorRuntime.awrap(router.push(\"/\"));\n\n          case 13:\n            _context.next = 18;\n            break;\n\n          case 15:\n            _context.prev = 15;\n            _context.t0 = _context[\"catch\"](3);\n            setErrorMsg(getErrorMessage(_context.t0));\n\n          case 18:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[3, 15]]);\n  }\n\n  var classes = useStyles();\n  return __jsx(Container, {\n    component: \"main\",\n    maxWidth: \"xs\"\n  }, __jsx(CssBaseline, null), __jsx(\"div\", {\n    className: classes.paper\n  }, __jsx(Logo, null), __jsx(Typography, {\n    component: \"h1\",\n    variant: \"h5\"\n  }, \"\\u0110\\u0103ng nh\\u1EADp\"), __jsx(\"form\", {\n    className: classes.form,\n    noValidate: true,\n    onSubmit: handleSubmit\n  }, __jsx(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    required: true,\n    fullWidth: true,\n    id: \"email\",\n    label: \"T\\xE0i kho\\u1EA3n\",\n    name: \"email\",\n    autoComplete: \"email\",\n    autoFocus: true\n  }), __jsx(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    required: true,\n    fullWidth: true,\n    name: \"password\",\n    label: \"M\\u1EADt kh\\u1EA9u\",\n    type: \"password\",\n    id: \"password\",\n    autoComplete: \"current-password\"\n  }), __jsx(Button, {\n    type: \"submit\",\n    fullWidth: true,\n    variant: \"contained\",\n    color: \"primary\",\n    className: classes.submit\n  }, \"\\u0110\\u0103ng Nh\\u1EADp\"), __jsx(Grid, {\n    container: true\n  }, __jsx(Grid, {\n    item: true\n  }, __jsx(Link, {\n    href: \"/signup\",\n    variant: \"body2\"\n  }, \"Đăng ký\")))), errorMsg));\n}\n\nexport default SignIn;","map":null,"metadata":{},"sourceType":"module"}